# Start for docker + nginx + php-fpm


---
Запуск NginX + php-fpm
---

Данный проект служит исключительно для знакомства с Docker.

Все Dockerfile находятся в директории docker отдельно для каждого сервиса: nginx, php-fpm и т.д.
Менять версию php или nginx необходимо в соответствующем файле Docker в директории сервисов.

При первом запуске будут скачаны и "сбилжены" образы php-fpm и nginx.

### С помощью утилиты Make  
установка утилиты: **sudo apt update** далее **sudo apt install make**

1. **make init** - запустит команды остановки текущих контейнеров, билда образов и запуска контейнеров Nginx и php-fpm
2. **make up** - запускает текущие контейнеры из docker-compose
3. **make down** - закрывает контейнеры, удаляет созданную виртуальную сеть
4. **make restart** - закрывает контейнеры, а затем снова запускает

### С помощью простого docker-compose

1. **docker-compose up -d** - запустить контейнеры в фоне
2. **docker-compose down** - завершить работу контейнеров

Запущенный сайт доступен по http://localhost:8080, версию php можно посмотреть здесь: http://localhost:8080/info.php

В файле .env можно указать префикс запускаемых контейнеров, иначе они будут взяты из названия директории откуда происходит запуск.


---
Запуск Docker через WSL2 на Windows
---

Ниже находится краткая инструкция для запуска полноценного Docker на Windows с возможностью работы через Makefile и тд.

1) Качаем Docker с офф. сайта https://www.docker.com/
2) Включаем поддержку WSL в Windows **"параметры -> приложения -> Программы и компоненты (Справа вверху) -> Включение и отключение компонентов Windows -> Подсистема Windows для Linux."**
3) Перезагрузить компьютер
4) Устанавливаем Docker
5) При необходимости он потребует через Bios включить аппартную виртуализацию
6) Затем, если все установилось, стартуем докер. Первый раз может занять несколько минут 2-10.
7) Качаем и устанавливаем обновление WSL2 для подсистемы
   https://docs.microsoft.com/ru-ru/windows/wsl/install-win10#step-4---download-the-linux-kernel-update-package
8) Устанавливаем WSL2 по дефолту из Power Shell или Windows Terminal (ниже)     
   **wsl --set-default-version 2**
8) Качаем для удобства из Microsoft Store оболочку Windows Terminal
9) Качаем оттуда же Ubuntu
10) Теперь можно из Windows Terminal в выпадающем списке запускать консоль установленного дистрибутива Linux
11) Для взаимодействия с Docker. Открываем настройки докера, убедимся, что стоит галочка **"Use the WSL 2 based engine"**
12) Переходим в настройках докера во вкладку Resourses - WSL integration - ставим галочку **"Enable integration with my default WSL distro"** -
    включаем ниже переключатель у вашего дистрибутива Linux, который должен был там появиться автоматом.
13) Теперь из Windows Terminal - создаем вкладку с консолью Linux и можно выполнять команты, в том числе с Docker.
    Для теста можно запустить команду: **docker run hello-world**

